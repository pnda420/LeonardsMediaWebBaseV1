<app-page-title title="Kontakt"></app-page-title>
<section class="contact">
  <div class="container">

    <div class="contact__grid">

      <!-- Sofort-Kontakt Sidebar -->
      <aside class="contact__sidebar">

        <!-- Quick Contact Cards -->
        <div class="quick-contact">
          <h3>Schneller Kontakt</h3>
          <div class="quick__list">
            <a class="quick__card" href="mailto:tom@leonardsmedia.de">
              <div class="quick__icon">
                <span class="material-symbols-outlined ms-fill">mail</span>
              </div>
              <div class="quick__content">
                <span class="quick__title">E-Mail schreiben</span>
                <span class="quick__value">tom&#64;leonardsmedia.de</span>
                <span class="quick__meta">Antwort in ~24h</span>
              </div>
            </a>
          </div>
        </div>

        <!-- Info Card -->
        <div class="info-card">
          <div class="info-card__icon">
            <span class="material-symbols-outlined ms-fill">info</span>
          </div>
          <h3>Was passiert als Nächstes?</h3>
          <ul class="info-list">
            <li>
              <span class="material-symbols-outlined ms-fill">check_circle</span>
              <span>Ich melde mich innerhalb von 24h</span>
            </li>
            <li>
              <span class="material-symbols-outlined ms-fill">check_circle</span>
              <span>Wir klären deine Anforderungen</span>
            </li>
            <li>
              <span class="material-symbols-outlined ms-fill">check_circle</span>
              <span>Du bekommst eine ehrliche Einschätzung</span>
            </li>
            <li>
              <span class="material-symbols-outlined ms-fill">check_circle</span>
              <span>Keine Verpflichtung, keine versteckten Kosten</span>
            </li>
          </ul>
        </div>

        <!-- Trust Badge -->
        <div class="trust-badge">
          <span class="material-symbols-outlined">verified</span>
          <div>
            <strong>Zufriedenheitsgarantie</strong>
            <p>14 Tage Geld-zurück bei Unzufriedenheit</p>
          </div>
        </div>

      </aside>

      <!-- Main Content Area -->
      <div class="contact__main">

        <!-- Erfolgsansicht -->
        <div class="success-card" *ngIf="state === 'success'" role="status" aria-live="polite">
          <div class="success-icon">
            <span class="material-symbols-outlined ms-fill">check_circle</span>
          </div>
          <h2>Danke! Nachricht angekommen.</h2>
          <p>Ich melde mich innerhalb von 24 Stunden bei dir.</p>
          <button class="btn btn--secondary" type="button" (click)="newMessage()">
            <span class="material-symbols-outlined ms-size-20">add</span>
            Neue Nachricht senden
          </button>
        </div>

        <!-- Formular -->
        <form class="contact__form" *ngIf="state !== 'success'" (ngSubmit)="submit()" #f="ngForm" novalidate
          [class.is-loading]="busy" [attr.aria-busy]="busy">

          <div class="form-header">
            <h2>Schnelle Nachricht</h2>
            <p class="form-subtitle">2–3 Sätze reichen völlig aus</p>
          </div>

          <!-- Name Field -->
          <div class="field" [class.has-error]="f.submitted && !model.name">
            <label for="name">
              Dein Name
              <span class="required">*</span>
            </label>
            <div class="input-wrapper">
              <span class="input-icon material-symbols-outlined">person</span>
              <input id="name" name="name" type="text" [(ngModel)]="model.name" placeholder="Max Mustermann" required
                [disabled]="busy" autocomplete="name" />
            </div>
            <small *ngIf="f.submitted && !model.name" class="error-message">
              <span class="material-symbols-outlined">error</span>
              Bitte Namen angeben
            </small>
          </div>

          <!-- Email Field -->
          <div class="field" [class.has-error]="f.submitted && !model.email">
            <label for="email">
              E-Mail
              <span class="required">*</span>
            </label>
            <div class="input-wrapper">
              <span class="input-icon material-symbols-outlined">mail</span>
              <input id="email" name="email" type="email" [(ngModel)]="model.email" placeholder="max@beispiel.de"
                required [disabled]="busy" autocomplete="email" inputmode="email" />
            </div>
            <small *ngIf="f.submitted && !model.email" class="error-message">
              <span class="material-symbols-outlined">error</span>
              Bitte E-Mail angeben
            </small>
          </div>

          <!-- Service Select -->
          <div class="field">
            <label for="service">Was brauchst du?</label>
            <div class="input-wrapper">
              <span class="input-icon material-symbols-outlined">work</span>
              <select id="service" name="service" [(ngModel)]="model.service" [disabled]="busy">
                <option value="">Noch nicht sicher / Beratung gewünscht</option>
                <option *ngFor="let service of services" [value]="service.title">
                  {{ service.title }}
                </option>
              </select>
            </div>
          </div>

          <!-- Message Field -->
          <div class="field">
            <label for="message">Worum geht's?</label>
            <div class="input-wrapper">
              <textarea id="message" name="message" rows="5" [(ngModel)]="model.message"
                placeholder="z.B. 'Ich brauche eine Buchungsplattform für mein Studio' oder 'Wir wollen unsere Excel-Liste in eine Web-App umwandeln'"
                [disabled]="busy"></textarea>
            </div>
          </div>

          <!-- Callback Toggle -->
          <div class="field field--checkbox">
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="model.callback" name="callback" [disabled]="busy" />
              <span class="checkbox-custom"></span>
              <span class="checkbox-text">
                <span class="material-symbols-outlined">call</span>
                Lieber Rückruf statt E-Mail?
              </span>
            </label>
          </div>

          <!-- Phone Field (conditional) -->
          <div class="field" *ngIf="model.callback">
            <label for="phone">Telefonnummer</label>
            <div class="input-wrapper">
              <span class="input-icon material-symbols-outlined">phone</span>
              <input id="phone" type="tel" name="phone" [(ngModel)]="model.phone" placeholder="Deine Telefonnummer"
                [disabled]="busy" inputmode="tel" autocomplete="tel" />
            </div>
          </div>

          <!-- Submit Button -->
          <div class="form-actions">
            <button class="btn btn--primary btn--large" type="submit" [disabled]="busy">
              <span *ngIf="!busy">
                <span class="material-symbols-outlined ms-size-20">send</span>
                Nachricht senden
              </span>
              <span *ngIf="busy" class="loading-content">
                <span class="spinner"></span>
                Wird gesendet…
              </span>
            </button>
            <p class="form-meta">
              <span class="material-symbols-outlined">schedule</span>
              Antwort in der Regel innerhalb von 24 Stunden
            </p>
          </div>

          <!-- Privacy Notice -->
          <p class="privacy-notice">
            <span class="material-symbols-outlined">lock</span>
            Mit dem Absenden stimmst du der Verarbeitung deiner Daten zur Bearbeitung deiner Anfrage zu.
            <a (click)="router.navigate(['/policy'])">Datenschutz</a>
          </p>

          <!-- Error Message -->
          <div *ngIf="state === 'error'" class="alert alert--error">
            <span class="material-symbols-outlined ms-fill">error</span>
            <div>
              <strong>Das hat leider nicht geklappt.</strong>
              <p>Schreib mir bitte direkt eine E-Mail oder ruf an.</p>
            </div>
          </div>

        </form>

      </div>

    </div>
  </div>
</section>